--drop procedure LOG_PROCEDURE;
CREATE OR REPLACE PROCEDURE LOG_PROCEDURE(
    TABLE_NAME IN       VARCHAR,
    OPERATION IN        VARCHAR,
    OLD_VALUE IN        VARCHAR,
    NEW_VALUE IN        VARCHAR)
IS 
BEGIN
  INSERT INTO LOGS(TABLE_NAME,EXECUTED_BY_USER,EVENT_TIME,OPERATION,OLD_VALUE,NEW_VALUE) 
    VALUES(TABLE_NAME,USER,SYSDATE,OPERATION,OLD_VALUE,NEW_VALUE);
END LOG_PROCEDURE;
------------------------------USERS_TRIGGER-------------------------------------
--DROP TRIGGER USERS_BEFORE;
CREATE OR REPLACE TRIGGER USERS_BEFORE 
BEFORE INSERT OR UPDATE OR DELETE ON USERS
FOR EACH ROW
DECLARE
  OPER VARCHAR(10);
BEGIN
  IF INSERTING THEN OPER := 'INSERT';
  ELSIF UPDATING THEN OPER := 'UPDATE';
  ELSIF DELETING THEN OPER := 'DELETE';
  END IF;
  
  LOG_PROCEDURE('USERS',OPER,NULL,NULL);
END;
----------==============================----------
--DROP TRIGGER USERS_AFTER
CREATE OR REPLACE TRIGGER USERS_AFTER 
BEFORE INSERT OR UPDATE OR DELETE ON USERS
FOR EACH ROW
DECLARE
  OPER VARCHAR(10);
  OLD_VALUE VARCHAR(2000);
  NEW_VALUE VARCHAR(2000);
BEGIN
  IF INSERTING THEN OPER := 'INSERT';
  ELSIF UPDATING THEN OPER := 'UPDATE';
  ELSIF DELETING THEN OPER := 'DELETE';
  END IF;
  
  OLD_VALUE := :OLD.ID||' '||:OLD.FIRST_NAME||' '||:OLD.LAST_NAME||' '||:OLD.AGE||' '||:OLD.EMAIL||' '||:OLD.PASS||' '||:OLD.INFO||' '||:OLD.AVATAR;
  NEW_VALUE := :NEW.ID||' '||:NEW.FIRST_NAME||' '||:NEW.LAST_NAME||' '||:NEW.AGE||' '||:NEW.EMAIL||' '||:NEW.PASS||' '||:NEW.INFO||' '||:NEW.AVATAR;
  
  LOG_PROCEDURE('USERS',OPER,OLD_VALUE,NEW_VALUE);
END;
------------------------------ALBUMS_TRIGGER------------------------------------
--DROP TRIGGER ALBUMS_BEFORE;
CREATE OR REPLACE TRIGGER ALBUMS_BEFORE 
BEFORE INSERT OR UPDATE OR DELETE ON ALBUMS
FOR EACH ROW
DECLARE
  OPER VARCHAR(10);
BEGIN
  IF INSERTING THEN OPER := 'INSERT';
  ELSIF UPDATING THEN OPER := 'UPDATE';
  ELSIF DELETING THEN OPER := 'DELETE';
  END IF;
  
  LOG_PROCEDURE('ALBUMS',OPER,NULL,NULL);
END;
----------==============================----------
--DROP TRIGGER ALBUMS_AFTER
CREATE OR REPLACE TRIGGER ALBUMS_AFTER 
BEFORE INSERT OR UPDATE OR DELETE ON ALBUMS
FOR EACH ROW
DECLARE
  OPER VARCHAR(10);
  OLD_VALUE VARCHAR(2000);
  NEW_VALUE VARCHAR(2000);
BEGIN
  IF INSERTING THEN OPER := 'INSERT';
  ELSIF UPDATING THEN OPER := 'UPDATE';
  ELSIF DELETING THEN OPER := 'DELETE';
  END IF;
  
  OLD_VALUE := :OLD.ID||' '||:OLD.TITLE||' '||:OLD.USER_ID||' '||:OLD.CREATED;
  NEW_VALUE := :NEW.ID||' '||:NEW.TITLE||' '||:NEW.USER_ID||' '||:NEW.CREATED;
  
  LOG_PROCEDURE('ALBUMS',OPER,OLD_VALUE,NEW_VALUE);
END;
------------------------------PHOTOS_TRIGGER------------------------------------
--DROP TRIGGER PHOTOS_BEFORE;
CREATE OR REPLACE TRIGGER PHOTOS_BEFORE 
BEFORE INSERT OR UPDATE OR DELETE ON PHOTOS
FOR EACH ROW
DECLARE
  OPER VARCHAR(10);
BEGIN
  IF INSERTING THEN OPER := 'INSERT';
  ELSIF UPDATING THEN OPER := 'UPDATE';
  ELSIF DELETING THEN OPER := 'DELETE';
  END IF;
  
  LOG_PROCEDURE('PHOTOS',OPER,NULL,NULL);
END;
----------==============================----------
--DROP TRIGGER PHOTOS_AFTER
CREATE OR REPLACE TRIGGER PHOTOS_AFTER 
BEFORE INSERT OR UPDATE OR DELETE ON PHOTOS
FOR EACH ROW
DECLARE
  OPER VARCHAR(10);
  OLD_VALUE VARCHAR(2000);
  NEW_VALUE VARCHAR(2000);
BEGIN
  IF INSERTING THEN OPER := 'INSERT';
  ELSIF UPDATING THEN OPER := 'UPDATE';
  ELSIF DELETING THEN OPER := 'DELETE';
  END IF;
  
  OLD_VALUE := :OLD.ID||' '||:OLD.PHOTO||' '||:OLD.ALBUM_ID||' '||:OLD.CREATED||' '||:OLD.LONGITUDE||' '||:OLD.LATITUDE;
  NEW_VALUE := :NEW.ID||' '||:NEW.PHOTO||' '||:NEW.ALBUM_ID||' '||:NEW.CREATED||' '||:NEW.LONGITUDE||' '||:NEW.LATITUDE;
  
  LOG_PROCEDURE('PHOTOS',OPER,OLD_VALUE,NEW_VALUE);
END;
------------------------------COMMENTS_TRIGGER----------------------------------
--DROP TRIGGER COMMENTS_BEFORE;
CREATE OR REPLACE TRIGGER COMMENTS_BEFORE 
BEFORE INSERT OR UPDATE OR DELETE ON COMMENTS
FOR EACH ROW
DECLARE
  OPER VARCHAR(10);
BEGIN
  IF INSERTING THEN OPER := 'INSERT';
  ELSIF UPDATING THEN OPER := 'UPDATE';
  ELSIF DELETING THEN OPER := 'DELETE';
  END IF;
  
  LOG_PROCEDURE('COMMENTS',OPER,NULL,NULL);
END;
----------==============================----------
--DROP TRIGGER COMMENTS_AFTER
CREATE OR REPLACE TRIGGER COMMENTS_AFTER 
BEFORE INSERT OR UPDATE OR DELETE ON COMMENTS
FOR EACH ROW
DECLARE
  OPER VARCHAR(10);
  OLD_VALUE VARCHAR(2000);
  NEW_VALUE VARCHAR(2000);
BEGIN
  IF INSERTING THEN OPER := 'INSERT';
  ELSIF UPDATING THEN OPER := 'UPDATE';
  ELSIF DELETING THEN OPER := 'DELETE';
  END IF;
  
  OLD_VALUE := :OLD.ID||' '||:OLD.INFO||' '||:OLD.PHOTO_ID||' '||:OLD.USER_ID||' '||:OLD.CREATED;
  NEW_VALUE := :NEW.ID||' '||:NEW.INFO||' '||:NEW.PHOTO_ID||' '||:NEW.USER_ID||' '||:NEW.CREATED;
  
  LOG_PROCEDURE('COMMENTS',OPER,OLD_VALUE,NEW_VALUE);
END;
------------------------------FRIENDS_TRIGGER-----------------------------------
--DROP TRIGGER FRIENDS_BEFORE;
CREATE OR REPLACE TRIGGER FRIENDS_BEFORE 
BEFORE INSERT OR UPDATE OR DELETE ON FRIENDS
FOR EACH ROW
DECLARE
  OPER VARCHAR(10);
BEGIN
  IF INSERTING THEN OPER := 'INSERT';
  ELSIF UPDATING THEN OPER := 'UPDATE';
  ELSIF DELETING THEN OPER := 'DELETE';
  END IF;
  
  LOG_PROCEDURE('FRIENDS',OPER,NULL,NULL);
END;
----------==============================----------
--DROP TRIGGER FRIENDS_AFTER
CREATE OR REPLACE TRIGGER FRIENDS_AFTER 
BEFORE INSERT OR UPDATE OR DELETE ON FRIENDS
FOR EACH ROW
DECLARE
  OPER VARCHAR(10);
  OLD_VALUE VARCHAR(2000);
  NEW_VALUE VARCHAR(2000);
BEGIN
  IF INSERTING THEN OPER := 'INSERT';
  ELSIF UPDATING THEN OPER := 'UPDATE';
  ELSIF DELETING THEN OPER := 'DELETE';
  END IF;
  
  OLD_VALUE := :OLD.USER_1||' '||:OLD.USER_2;
  NEW_VALUE := :NEW.USER_1||' '||:NEW.USER_2;
  
  LOG_PROCEDURE('FRIENDS',OPER,OLD_VALUE,NEW_VALUE);
END;
------------------------------USERS_TO_DIALOGS_TRIGGER--------------------------
--DROP TRIGGER USERS_TO_DIALOGS_BEFORE;
CREATE OR REPLACE TRIGGER USERS_TO_DIALOGS_BEFORE 
BEFORE INSERT OR UPDATE OR DELETE ON USERS_TO_DIALOGS
FOR EACH ROW
DECLARE
  OPER VARCHAR(10);
BEGIN
  IF INSERTING THEN OPER := 'INSERT';
  ELSIF UPDATING THEN OPER := 'UPDATE';
  ELSIF DELETING THEN OPER := 'DELETE';
  END IF;
  
  LOG_PROCEDURE('USERS_TO_DIALOGS',OPER,NULL,NULL);
END;
----------==============================----------
--DROP TRIGGER USERS_TO_DIALOGS_AFTER
CREATE OR REPLACE TRIGGER USERS_TO_DIALOGS_AFTER 
BEFORE INSERT OR UPDATE OR DELETE ON USERS_TO_DIALOGS
FOR EACH ROW
DECLARE
  OPER VARCHAR(10);
  OLD_VALUE VARCHAR(2000);
  NEW_VALUE VARCHAR(2000);
BEGIN
  IF INSERTING THEN OPER := 'INSERT';
  ELSIF UPDATING THEN OPER := 'UPDATE';
  ELSIF DELETING THEN OPER := 'DELETE';
  END IF;
  
  OLD_VALUE := :OLD.USER_ID||' '||:OLD.DIALOG_ID;
  NEW_VALUE := :NEW.USER_ID||' '||:NEW.DIALOG_ID;
  
  LOG_PROCEDURE('USERS_TO_DIALOGS',OPER,OLD_VALUE,NEW_VALUE);
END;
------------------------------DIALOGS_TRIGGER-----------------------------------
--DROP TRIGGER DIALOGS_BEFORE;
CREATE OR REPLACE TRIGGER DIALOGS_BEFORE 
BEFORE INSERT OR UPDATE OR DELETE ON DIALOGS
FOR EACH ROW
DECLARE
  OPER VARCHAR(10);
BEGIN
  IF INSERTING THEN OPER := 'INSERT';
  ELSIF UPDATING THEN OPER := 'UPDATE';
  ELSIF DELETING THEN OPER := 'DELETE';
  END IF;
  
  LOG_PROCEDURE('DIALOGS',OPER,NULL,NULL);
END;
----------==============================----------
--DROP TRIGGER DIALOGS_AFTER
CREATE OR REPLACE TRIGGER DIALOGS_AFTER 
BEFORE INSERT OR UPDATE OR DELETE ON DIALOGS
FOR EACH ROW
DECLARE
  OPER VARCHAR(10);
  OLD_VALUE VARCHAR(2000);
  NEW_VALUE VARCHAR(2000);
BEGIN
  IF INSERTING THEN OPER := 'INSERT';
  ELSIF UPDATING THEN OPER := 'UPDATE';
  ELSIF DELETING THEN OPER := 'DELETE';
  END IF;
  
  OLD_VALUE := :OLD.ID||' '||:OLD.TITLE||' '||:OLD.CREATED;
  NEW_VALUE := :NEW.ID||' '||:NEW.TITLE||' '||:NEW.CREATED;
  
  LOG_PROCEDURE('DIALOGS',OPER,OLD_VALUE,NEW_VALUE);
END;
------------------------------MESSAGES_TRIGGER----------------------------------
--DROP TRIGGER MESSAGES_BEFORE;
CREATE OR REPLACE TRIGGER MESSAGES_BEFORE 
BEFORE INSERT OR UPDATE OR DELETE ON MESSAGES
FOR EACH ROW
DECLARE
  OPER VARCHAR(10);
BEGIN
  IF INSERTING THEN OPER := 'INSERT';
  ELSIF UPDATING THEN OPER := 'UPDATE';
  ELSIF DELETING THEN OPER := 'DELETE';
  END IF;
  
  LOG_PROCEDURE('MESSAGES',OPER,NULL,NULL);
END;
----------==============================----------
--DROP TRIGGER MESSAGES_AFTER
CREATE OR REPLACE TRIGGER MESSAGES_AFTER 
BEFORE INSERT OR UPDATE OR DELETE ON MESSAGES
FOR EACH ROW
DECLARE
  OPER VARCHAR(10);
  OLD_VALUE VARCHAR(2000);
  NEW_VALUE VARCHAR(2000);
BEGIN
  IF INSERTING THEN OPER := 'INSERT';
  ELSIF UPDATING THEN OPER := 'UPDATE';
  ELSIF DELETING THEN OPER := 'DELETE';
  END IF;
  
  OLD_VALUE := :OLD.ID||' '||:OLD.INFO||' '||:OLD.USER_ID||' '||:OLD.DIALOG_ID||' '||:OLD.CREATED;
  NEW_VALUE := :NEW.ID||' '||:NEW.INFO||' '||:NEW.USER_ID||' '||:NEW.DIALOG_ID||' '||:NEW.CREATED;
  
  LOG_PROCEDURE('MESSAGES',OPER,OLD_VALUE,NEW_VALUE);
END;
------------------------------NEWS_TRIGGER--------------------------------------
--DROP TRIGGER NEWS_BEFORE;
CREATE OR REPLACE TRIGGER NEWS_BEFORE 
BEFORE INSERT OR UPDATE OR DELETE ON NEWS
FOR EACH ROW
DECLARE
  OPER VARCHAR(10);
BEGIN
  IF INSERTING THEN OPER := 'INSERT';
  ELSIF UPDATING THEN OPER := 'UPDATE';
  ELSIF DELETING THEN OPER := 'DELETE';
  END IF;
  
  LOG_PROCEDURE('NEWS',OPER,NULL,NULL);
END;
----------==============================----------
--DROP TRIGGER NEWS_AFTER
CREATE OR REPLACE TRIGGER NEWS_AFTER 
BEFORE INSERT OR UPDATE OR DELETE ON NEWS
FOR EACH ROW
DECLARE
  OPER VARCHAR(10);
  OLD_VALUE VARCHAR(2000);
  NEW_VALUE VARCHAR(2000);
BEGIN
  IF INSERTING THEN OPER := 'INSERT';
  ELSIF UPDATING THEN OPER := 'UPDATE';
  ELSIF DELETING THEN OPER := 'DELETE';
  END IF;
  
  OLD_VALUE := :OLD.ID||' '||:OLD.TITLE||' '||:OLD.INFO||' '||:OLD.PHOTO||' '||:OLD.CREATED||' '||:OLD.USER_ID;
  NEW_VALUE := :NEW.ID||' '||:NEW.TITLE||' '||:NEW.INFO||' '||:NEW.PHOTO||' '||:NEW.CREATED||' '||:NEW.USER_ID;
  
  LOG_PROCEDURE('NEWS',OPER,OLD_VALUE,NEW_VALUE);
END;
------------------------------FISHES_TRIGGER------------------------------------
--DROP TRIGGER FISHES_BEFORE;
CREATE OR REPLACE TRIGGER FISHES_BEFORE 
BEFORE INSERT OR UPDATE OR DELETE ON FISHES
FOR EACH ROW
DECLARE
  OPER VARCHAR(10);
BEGIN
  IF INSERTING THEN OPER := 'INSERT';
  ELSIF UPDATING THEN OPER := 'UPDATE';
  ELSIF DELETING THEN OPER := 'DELETE';
  END IF;
  
  LOG_PROCEDURE('FISHES',OPER,NULL,NULL);
END;
----------==============================----------
--DROP TRIGGER FISHES_AFTER
CREATE OR REPLACE TRIGGER FISHES_AFTER 
BEFORE INSERT OR UPDATE OR DELETE ON FISHES
FOR EACH ROW
DECLARE
  OPER VARCHAR(10);
  OLD_VALUE VARCHAR(2000);
  NEW_VALUE VARCHAR(2000);
BEGIN
  IF INSERTING THEN OPER := 'INSERT';
  ELSIF UPDATING THEN OPER := 'UPDATE';
  ELSIF DELETING THEN OPER := 'DELETE';
  END IF;
  
  OLD_VALUE := :OLD.ID||' '||:OLD.NAME||' '||:OLD.CREATED||' '||:OLD.INFO||' '||:OLD.PHOTO||' '||:OLD.USER_ID;
  NEW_VALUE := :NEW.ID||' '||:NEW.NAME||' '||:NEW.CREATED||' '||:NEW.INFO||' '||:NEW.PHOTO||' '||:NEW.USER_ID;
  
  LOG_PROCEDURE('FISHES',OPER,OLD_VALUE,NEW_VALUE);
END;
------------------------------STATE_INSPECTIONS_TRIGGER-------------------------
--DROP TRIGGER STATE_INSPECTIONS_BEFORE;
CREATE OR REPLACE TRIGGER STATE_INSPECTIONS_BEFORE 
BEFORE INSERT OR UPDATE OR DELETE ON STATE_INSPECTIONS
FOR EACH ROW
DECLARE
  OPER VARCHAR(10);
BEGIN
  IF INSERTING THEN OPER := 'INSERT';
  ELSIF UPDATING THEN OPER := 'UPDATE';
  ELSIF DELETING THEN OPER := 'DELETE';
  END IF;
  
  LOG_PROCEDURE('STATE_INSPECTIONS',OPER,NULL,NULL);
END;
----------==============================----------
--DROP TRIGGER STATE_INSPECTIONS_AFTER
CREATE OR REPLACE TRIGGER STATE_INSPECTIONS_AFTER 
BEFORE INSERT OR UPDATE OR DELETE ON STATE_INSPECTIONS
FOR EACH ROW
DECLARE
  OPER VARCHAR(10);
  OLD_VALUE VARCHAR(2000);
  NEW_VALUE VARCHAR(2000);
BEGIN
  IF INSERTING THEN OPER := 'INSERT';
  ELSIF UPDATING THEN OPER := 'UPDATE';
  ELSIF DELETING THEN OPER := 'DELETE';
  END IF;
  
  OLD_VALUE := :OLD.ID||' '||:OLD.REGION||' '||:OLD.ADDRESS||' '||:OLD.PHONE||' '||:OLD.CREATED||' '||:OLD.USER_ID;
  NEW_VALUE := :NEW.ID||' '||:NEW.REGION||' '||:NEW.ADDRESS||' '||:NEW.PHONE||' '||:NEW.CREATED||' '||:NEW.USER_ID;
  
  LOG_PROCEDURE('STATE_INSPECTIONS',OPER,OLD_VALUE,NEW_VALUE);
END;
--------------------------------------------------------------------------------
DROP TRIGGER USERS_BEFORE;
DROP TRIGGER USERS_AFTER;

DROP TRIGGER ALBUMS_BEFORE;
DROP TRIGGER ALBUMS_AFTER;

DROP TRIGGER PHOTOS_BEFORE;
DROP TRIGGER PHOTOS_AFTER;

DROP TRIGGER COMMENTS_BEFORE;
DROP TRIGGER COMMENTS_AFTER;

DROP TRIGGER FRIENDS_BEFORE;
DROP TRIGGER FRIENDS_AFTER;

DROP TRIGGER USERS_TO_DIALOGS_BEFORE;
DROP TRIGGER USERS_TO_DIALOGS_AFTER;

DROP TRIGGER DIALOGS_BEFORE;
DROP TRIGGER DIALOGS_AFTER;

DROP TRIGGER MESSAGES_BEFORE;
DROP TRIGGER MESSAGES_AFTER;

DROP TRIGGER NEWS_BEFORE;
DROP TRIGGER NEWS_AFTER;

DROP TRIGGER FISHES_BEFORE;
DROP TRIGGER FISHES_AFTER;

DROP TRIGGER STATE_INSPECTIONS_BEFORE;
DROP TRIGGER STATE_INSPECTIONS_AFTER;
--------------------------------------------------------------------------------
SELECT * FROM USER_TRIGGERS;